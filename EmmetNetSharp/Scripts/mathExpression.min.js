!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mathExpression=e():t.mathExpression=e()}(this,(()=>(()=>{"use strict";var t={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);function n(t){return t>47&&t<58}function r(t){return 32===t||9===t||160===t}function o(t){return r(t)||10===t||13===t}class s{constructor(t,e,n){null==n&&"string"==typeof t&&(n=t.length),this.string=t,this.pos=this.start=e||0,this.end=n||0}eof(){return this.pos>=this.end}limit(t,e){return new s(this.string,t,e)}peek(){return this.string.charCodeAt(this.pos)}next(){if(this.pos<this.string.length)return this.string.charCodeAt(this.pos++)}eat(t){const e=this.peek(),n="function"==typeof t?t(e):e===t;return n&&this.next(),n}eatWhile(t){const e=this.pos;for(;!this.eof()&&this.eat(t););return this.pos!==e}backUp(t){this.pos-=t||1}current(){return this.substring(this.start,this.pos)}substring(t,e){return this.string.slice(t,e)}error(t,e=this.pos){return new i(`${t} at ${e+1}`,e,this.string)}}class i extends Error{constructor(t,e,n){super(t),this.pos=e,this.string=n}}const p=b("null",0);function u(t){const e="string"==typeof t?new s(t):t;let n,o=0,i=21;const u=[];for(;!e.eof();)e.eatWhile(r),e.start=e.pos,c(e)?(0==(1&i)&&a("Unexpected number",e),u.push(h(e.current())),i=10):y(e.peek())?(n=e.next(),g(n)&&16&i?(d(n)&&u.push(l(n,o)),i=21):(0==(2&i)&&a("Unexpected operator",e),u.push(f(n,o)),i=21)):e.eat(40)?(0==(4&i)&&a('Unexpected "("',e),o+=10,i=53):e.eat(41)?(o-=10,32&i?u.push(p):0==(8&i)&&a('Unexpected ")"',e),i=14):a("Unknown character",e);(o<0||o>=10)&&a('Unmatched "()"',e);const b=function(t){const e=[],n=[];let r=0;for(let o=0;o<t.length;o++){const s=t[o];if("num"===s.type)n.push(s);else{for(r+="op1"===s.type?1:2;e.length&&s.priority<=e[e.length-1].priority;)n.push(e.pop());e.push(s)}}return r+1===n.length+e.length?n.concat(e.reverse()):null}(u);return null===b&&a("Parity",e),b}function c(t){const e=t.pos;return!(!t.eat(46)||!t.eatWhile(n))||(!(!t.eatWhile(n)||t.eat(46)&&!t.eatWhile(n))||(t.pos=e,!1))}function h(t,e){return b("num",parseFloat(t),e)}function l(t,e=0){return 45===t&&(e+=2),b("op1",t,e)}function f(t,e=0){return 42===t?e+=1:47!==t&&92!==t||(e+=2),b("op2",t,e)}function a(t,e){throw e&&(t+=` at column ${e.pos} of expression`),new Error(t)}function g(t){return function(t){return 43===t}(t)||d(t)}function d(t){return 45===t}function y(t){return 43===t||45===t||42===t||47===t||92===t}function b(t,e,n=0){return{type:t,value:e,priority:n}}const x={lookAhead:!0,whitespace:!0};function m(t){if(n(w(t))){t.pos--;let e,r=!1;for(;t.pos>=0;){if(e=w(t),46===e){if(r)break;r=!0}else if(!n(e))break;t.pos--}return!0}return!1}function w(t){return t.text.charCodeAt(t.pos-1)}function v(t){return t.text.charCodeAt(t.pos)}const k={45:t=>-t},A={43:(t,e)=>t+e,45:(t,e)=>t-e,42:(t,e)=>t*e,47:(t,e)=>t/e,92:(t,e)=>Math.floor(t/e)};const j=function(t){if(Array.isArray(t)||(t=u(t)),!t||!t.length)return null;const e=[];let n,r,o;for(let s=0,i=t.length;s<i;s++){const i=t[s];if("num"===i.type)e.push(i.value);else if("op2"===i.type)r=e.pop(),n=e.pop(),o=A[i.value],e.push(o(n,r));else{if("op1"!==i.type)throw new Error("Invalid expression");n=e.pop(),o=k[i.value],e.push(o(n))}}if(e.length>1)throw new Error("Invalid Expression (parity)");return e[0]};var E=function(t,e=t.length,n){const r=Object.assign(Object.assign({},x),n),s={text:t,pos:e};let i;if(r.lookAhead&&41===v(s)){s.pos++;const e=t.length;for(;s.pos<e&&(i=v(s),41===i||r.whitespace&&o(i));)s.pos++}const p=s.pos;let u=0;for(;s.pos>=0;)if(!m(s)){if(i=w(s),41===i)u++;else if(40===i){if(!u)break;u--}else if(!(r.whitespace&&o(i)||g(i)||y(i)))break;s.pos--}if(s.pos!==p&&!u){for(;o(v(s));)s.pos++;return[s.pos,p]}return null},U=u;return globalThis.evaluate=j,globalThis.extract=E,globalThis.parse=U,e})()));